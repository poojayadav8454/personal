{% schema %}
{
  "name": "Tabbed Collection",
  "settings": [],
  "blocks": [
    {
      "type": "collection_tab",
      "name": "Collection Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_title",
          "label": "Tab Title"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        }
      ]
    }
  ],
  "max_blocks": 5,
  "presets": [{
    "name": "Tabbed Collection",
    "category": "Custom"
  }]
}
{% endschema %}

<style>
.tab-buttons {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-bottom: 24px;
  flex-wrap: wrap;
}
.tab-button {
  padding: 10px 18px;
  border-radius: 24px;
  border: none;
  cursor: pointer;
  background-color: #eee;
  font-weight: 600;
}
.tab-button.active {
  background-color: #00BCD4;
  color: white;
}
.tab-pane {
  display: none;
}
.tab-pane.active {
  display: block;
}
.products-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 20px;
}
.product-card {
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 12px;
  text-align: center;
}
.product-card img {
  max-width: 100%;
  border-radius: 6px;
}
.product-card h3 {
  font-size: 16px;
  margin: 8px 0;
}
.product-card .price {
  font-weight: bold;
  font-size: 18px;
  margin: 8px 0;
}
.product-card .btn {
  display: inline-block;
  padding: 10px 16px;
  background: black;
  color: white;
  border-radius: 6px;
  text-decoration: none;
  margin-top: 10px;
}
</style>

<div class="tab-collection-wrapper">
  <div class="tab-buttons">
    {% for block in section.blocks %}
      <button class="tab-button {% if forloop.first %}active{% endif %}" data-tab="tab-{{ forloop.index0 }}">
        {{ block.settings.tab_title }}
      </button>
    {% endfor %}
  </div>

  {% for block in section.blocks %}
    <div class="tab-pane {% if forloop.first %}active{% endif %}" id="tab-{{ forloop.index0 }}">
      <div class="products-grid">
          <ul class="scroll-list">
              {% for product in block.settings.collection.products limit: 10 %}
                <li class="scroll-item">
                  {% render 'card-product', card_product: product %}
                </li>
              {% endfor %}
            </ul>
      </div>
    </div>
  {% endfor %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const buttons = document.querySelectorAll('.tab-button');
  const panes = document.querySelectorAll('.tab-pane');

  buttons.forEach((btn, i) => {
    btn.addEventListener('click', () => {
      buttons.forEach(b => b.classList.remove('active'));
      panes.forEach(p => p.classList.remove('active'));

      btn.classList.add('active');
      panes[i].classList.add('active');
    });
  });
});
</script>
